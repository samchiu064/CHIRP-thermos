"use strict";(self["webpackChunkmy_project"]=self["webpackChunkmy_project"]||[]).push([[943],{4827:function(t,e,o){o.d(e,{er:function(){return x},Wf:function(){return b},dr:function(){return w},ye:function(){return L},gJ:function(){return y},FC:function(){return I},Vh:function(){return C},sG:function(){return _}});var s=o(6265),a=o.n(s);const n=a().create({baseURL:"https://vue3-course-api.hexschool.io/api/samchiu064-api/"}),c=()=>n.get("/cart"),i=t=>n.post("/cart",t),l=(t,e)=>n.put(`/cart/${e}`,t),r=t=>n.delete(`/cart/${t}`),u=(a().create({baseURL:"https://vue3-course-api.hexschool.io/api/samchiu064-api/"}),a().create({baseURL:"https://vue3-course-api.hexschool.io/api/samchiu064-api/"})),d=t=>u.post("/coupon",t),p=a().create({baseURL:"https://vue3-course-api.hexschool.io/api/samchiu064-api/"}),h=t=>p.get(`/order/${t}`),m=t=>p.post("/order",t),f=a().create({baseURL:"https://vue3-course-api.hexschool.io/api/samchiu064-api/"}),g=()=>f.get("/products"),b=c,y=i,_=l,x=r,I=d,w=h,C=m,L=g},4677:function(t,e,o){o.d(e,{x:function(){return i}});var s=o(4827),a=o(4301),n=o(6294);const c=(0,n.Z)(),i=(0,a.Q_)("cart",{state:()=>({cart:{},itemQty:0}),getters:{discount(){return this.cart.total-this.cart.final_total}},actions:{async getCartList(){c.isLoading=!0,await(0,s.Wf)().then((t=>{this.cart=t.data.data})).catch((t=>{console.log(t)})),c.isLoading=!1},async addCartItem(t,e){c.cartLoadingItem=t,c.cartItemIsAdded=!1,await(0,s.gJ)({data:{product_id:t,qty:e}}).then((t=>{c.cartLoadingItem="",c.cartItemIsAdded=!0,console.log(t)})).catch((t=>{c.cartItemIsAdded=!1,console.log(t)})),this.getCartList()},async updateCartItem({itemId:t,qty:e}){const o=e<=0?1:e;c.cartLoadingItem=t,await(0,s.sG)({data:{product_id:t,qty:o}},t).then((t=>{console.log(t)})).catch((t=>console.log(t))),this.getCartList(),c.cartLoadingItem=""},async deleteCartItem(t){c.cartDeletedItem=t,await(0,s.er)(t).then((t=>{console.log(t)})).catch((t=>console.log(t))),this.getCartList(),c.cartDeletedItem=""}}})},6294:function(t,e,o){var s=o(4301);e["Z"]=(0,s.Q_)("statusStore",{state:()=>({isLoading:!1,cartLoadingItem:"",cartDeletedItem:"",cartItemIsAdded:!1,couponIsApplied:!1,couponIsValid:!1,orderIsValid:!1})})},2943:function(t,e,o){o.r(e),o.d(e,{default:function(){return J}});var s=o(3396),a=o(7139),n=o(9242);const c=t=>((0,s.dD)("data-v-ba820e1a"),t=t(),(0,s.Cn)(),t),i={class:"col-12 col-lg-4"},l={class:"card"},r=c((()=>(0,s._)("h4",{class:"card-header fs-6 py-2 text-center"},"您的訂單",-1))),u={class:"list-group list-group-flush"},d={class:"list-group-item d-flex justify-content-between align-items-center py-3 px-0 mx-3"},p=c((()=>(0,s._)("h5",{class:"fs-6 m-0 fw-normal"},"小計",-1))),h={class:"fs-6 m-0 fw-medium"},m=c((()=>(0,s._)("li",{class:"list-group-item d-flex justify-content-between align-items-center py-3 px-0 mx-3"},[(0,s._)("h5",{class:"fs-6 m-0 fw-normal"},"運費"),(0,s._)("p",{class:"fs-6 m-0 fw-medium"},"免運費")],-1))),f={class:"list-group-item accordion accordion-flush py-3 px-0 mx-3"},g={class:"accordion-item"},b=c((()=>(0,s._)("h2",{class:"accordion-header",id:"flush-headingOne"},[(0,s._)("button",{class:"accordion-button collapsed px-3",type:"button","data-bs-toggle":"collapse","data-bs-target":"#flush-collapseOne","aria-expanded":"true","aria-controls":"flush-collapseOne"}," 套用折扣碼 ")],-1))),y={id:"flush-collapseOne",class:"accordion-collapse collapse","aria-labelledby":"flush-headingOne","data-bs-parent":"#accordionFlushExample"},_={class:"accordion-body"},x={class:"list-group-flush ps-0"},I=c((()=>(0,s._)("p",null,"已套用",-1))),w={class:"d-flex justify-content-between ps-2"},C={key:0,class:"text-danger fs-7 ps-3 m-0"},L={class:"list-group-item d-flex justify-content-between align-items-center pt-3 px-0 mx-3 border-bottom-0"},v=c((()=>(0,s._)("h5",{class:"fs-6 m-0"},"折扣",-1))),A={class:"fs-6 m-0 fw-medium"},k={class:"list-group-item d-flex justify-content-between align-items-center pb-3 px-0 mx-3 border-bottom-0"},V=c((()=>(0,s._)("h5",{class:"fs-5 m-0 fw-bold"},"總計",-1))),j={class:"fs-5 m-0 fw-bold"},D={class:"list-group-item d-flex justify-content-between align-items-center py-3 px-0 mx-3"},$=["disabled"];function U(t,e,o,c,U,q){return(0,s.wg)(),(0,s.iD)("div",i,[(0,s._)("div",l,[r,(0,s._)("ul",u,[(0,s._)("li",d,[p,(0,s._)("p",h,"NT$ "+(0,a.zw)(t.cart.total?.toLocaleString("en-us")),1)]),m,(0,s._)("li",f,[(0,s._)("div",g,[b,(0,s._)("div",y,[(0,s._)("div",_,[(0,s._)("ul",x,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(t.couponList,((t,e)=>((0,s.wg)(),(0,s.iD)("li",{key:t+e,class:"d-flex justify-content-between ps-2"},[(0,s._)("p",null,(0,a.zw)(t),1),I])))),128)),(0,s._)("li",w,[(0,s.wy)((0,s._)("input",{class:"form-control form-control-sm w-70",type:"text",placeholder:"請輸入折扣碼 summer","aria-label":"折扣碼輸入處","onUpdate:modelValue":e[0]||(e[0]=e=>t.couponCode=e),onClick:e[1]||(e[1]=()=>{t.couponIsValid=!0,t.couponIsApplied=!1})},null,512),[[n.nr,t.couponCode]]),(0,s._)("button",{type:"button",class:"btn btn-outline-secondary",onClick:e[2]||(e[2]=t=>q.addCoupon())}," 套用 ")])]),!t.couponIsValid&&0!==t.couponCode.length||t.couponIsApplied?((0,s.wg)(),(0,s.iD)("span",C,(0,a.zw)(q.errorMessage),1)):(0,s.kq)("",!0)])])])]),(0,s._)("li",L,[v,(0,s._)("p",A,"- "+(0,a.zw)(t.discount?.toLocaleString("en-us")),1)]),(0,s._)("li",k,[V,(0,s._)("p",j,"NT $"+(0,a.zw)(t.cart.final_total?.toLocaleString("en-us")),1)]),(0,s._)("li",D,[(0,s._)("button",{type:"button",class:"btn btn-dark w-100 rounded-pill",disabled:0===this.cart.carts?.length||"order"===this.$route.name&&!o.formIsValid,onClick:e[3]||(e[3]=t=>this.$router.push({name:o.nextPage}))}," 下一步 ",8,$)])])])])}var q=o(4301),z=o(4827),O=o(6294);const R=(0,O.Z)(),S=(0,q.Q_)("coupon",{state:()=>({couponCode:"",couponList:[]}),getters:{},actions:{async applyCoupon(){const t=this.couponCode;await(0,z.FC)({data:{code:t}}).then((e=>{if(e.data.success){if(this.couponList.includes(t))return void(R.couponIsApplied=!0);this.couponList.push(t),this.couponCode=""}else R.couponIsValid=!1;console.log(e)})).catch((t=>console.log(t)))}}});var Z=o(4677),Q={props:{nextPage:{type:String,required:!0},formIsValid:{type:Boolean,default:()=>!0}},computed:{errorMessage(){return this.couponIsValid?this.couponIsApplied?"已套用的優惠券":"":"無效的優惠券"},...(0,q.rn)(Z.x,["discount"]),...(0,q.Ah)(Z.x,["cart"]),...(0,q.Ah)(S,["couponCode","couponList"]),...(0,q.Ah)(O.Z,["couponIsApplied","couponIsValid"])},methods:{async addCoupon(){await this.applyCoupon(),await this.getCartList()},...(0,q.nv)(Z.x,["getCartList"]),...(0,q.nv)(S,["applyCoupon"])}},F=o(89);const G=(0,F.Z)(Q,[["render",U],["__scopeId","data-v-ba820e1a"]]);var J=G}}]);
//# sourceMappingURL=943.94730a09.js.map