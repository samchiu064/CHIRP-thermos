"use strict";(self["webpackChunkmy_project"]=self["webpackChunkmy_project"]||[]).push([[234,148],{4827:function(t,e,a){a.d(e,{er:function(){return w},Wf:function(){return g},dr:function(){return v},ye:function(){return L},gJ:function(){return _},FC:function(){return y},Vh:function(){return k},sG:function(){return I}});var r=a(6265),s=a.n(r);const d=s().create({baseURL:"https://vue3-course-api.hexschool.io/api/samchiu064-api/"}),l=()=>d.get("/cart"),n=t=>d.post("/cart",t),o=(t,e)=>d.put(`/cart/${e}`,t),i=t=>d.delete(`/cart/${t}`),c=(s().create({baseURL:"https://vue3-course-api.hexschool.io/api/samchiu064-api/"}),s().create({baseURL:"https://vue3-course-api.hexschool.io/api/samchiu064-api/"})),u=t=>c.post("/coupon",t),m=s().create({baseURL:"https://vue3-course-api.hexschool.io/api/samchiu064-api/"}),p=t=>m.get(`/order/${t}`),b=t=>m.post("/order",t),h=s().create({baseURL:"https://vue3-course-api.hexschool.io/api/samchiu064-api/"}),f=()=>h.get("/products"),g=l,_=n,I=o,w=i,y=u,v=p,k=b,L=f},4677:function(t,e,a){a.d(e,{x:function(){return n}});var r=a(4827),s=a(4301),d=a(6294);const l=(0,d.Z)(),n=(0,s.Q_)("cart",{state:()=>({cart:{},itemQty:0}),getters:{discount(){return this.cart.total-this.cart.final_total}},actions:{async getCartList(){l.isLoading=!0,await(0,r.Wf)().then((t=>{this.cart=t.data.data})).catch((t=>{})),l.isLoading=!1},async addCartItem(t,e){l.cartLoadingItem=t,l.cartItemIsAdded=!1,await(0,r.gJ)({data:{product_id:t,qty:e}}).then((t=>{l.cartLoadingItem="",l.cartItemIsAdded=!0})).catch((t=>{l.cartItemIsAdded=!1})),this.getCartList()},async updateCartItem({itemId:t,qty:e}){const a=e<=0?1:e;l.cartLoadingItem=t,await(0,r.sG)({data:{product_id:t,qty:a}},t).then((t=>{})).catch((t=>{})),this.getCartList(),l.cartLoadingItem=""},async deleteCartItem(t){l.cartDeletedItem=t,await(0,r.er)(t).then((t=>{})).catch((t=>{})),this.getCartList(),l.cartDeletedItem=""}}})},6294:function(t,e,a){var r=a(4301);e["Z"]=(0,r.Q_)("statusStore",{state:()=>({isLoading:!1,cartIsShown:!1,cartLoadingItem:"",cartDeletedItem:"",cartItemIsAdded:!1,couponIsApplied:!1,couponIsValid:!1,orderIsValid:!1})})},8686:function(t,e,a){a.d(e,{Z:function(){return b}});var r=a(3396);const s=["disabled"],d={for:"qty",class:"w-25 align-middle"},l=["disabled","value"],n=["disabled"];function o(t,e,a,o,i,c){return(0,r.wg)(),(0,r.iD)(r.HY,null,[a.hasOperators?((0,r.wg)(),(0,r.iD)("button",{key:0,class:"btn bi bi-dash fs-3 text-black-50",disabled:t.cartDeletedItem===a.itemId||1===a.qty,onClick:e[0]||(e[0]=e=>t.$emit("updateItem",{qty:a.qty-1,itemId:a.itemId}))},null,8,s)):(0,r.kq)("",!0),(0,r._)("label",d,[(0,r._)("input",{type:"number",class:"rounded form-control text-center w-100 text-black-50 bg-transparent",id:"qty",min:"1",disabled:t.cartDeletedItem===a.itemId||!a.hasOperators,value:a.qty,onChange:e[1]||(e[1]=e=>t.$emit("update:value",Number(e.target.value)))},null,40,l)]),a.hasOperators?((0,r.wg)(),(0,r.iD)("button",{key:1,class:"btn bi bi-plus fs-3 text-black-50",disabled:t.cartDeletedItem===a.itemId,onClick:e[2]||(e[2]=e=>t.$emit("updateItem",{qty:a.qty+1,itemId:a.itemId}))},null,8,n)):(0,r.kq)("",!0)],64)}var i=a(6294),c=a(4301),u={props:{hasOperators:{type:Boolean,default:!0},qty:{type:Number,default:1},itemId:{type:String,default:"defaultId"}},emits:["updateItem","update:value"],computed:{...(0,c.rn)(i.Z,["cartDeletedItem"])}},m=a(89);const p=(0,m.Z)(u,[["render",o],["__scopeId","data-v-893b448e"]]);var b=p},3371:function(t,e,a){a.d(e,{Z:function(){return _}});var r=a(3396),s=a(7139);const d={class:"table-responsive"},l={class:"table text-nowrap align-middle table-borderless border mb-3"},n=(0,r._)("thead",{class:"table-light border-bottom"},[(0,r._)("tr",null,[(0,r._)("th",{colspan:"2",scope:"col",class:"fw-normal"},"訂單資訊")])],-1),o=(0,r._)("th",{class:"fw-medium"},"Email",-1),i=(0,r._)("th",{class:"fw-medium"},"收件人名稱",-1),c=(0,r._)("th",{class:"fw-medium"},"收件人聯絡電話",-1),u=(0,r._)("th",{class:"fw-medium"},"收件人地址",-1),m=(0,r._)("th",{class:"fw-medium"},"備註",-1),p=(0,r._)("tr",null,[(0,r._)("th",{class:"fw-medium"},"付款狀態"),(0,r._)("td",null,"尚未付款")],-1);function b(t,e,a,b,h,f){return(0,r.wg)(),(0,r.iD)("div",d,[(0,r._)("table",l,[n,(0,r._)("tbody",null,[(0,r._)("tr",null,[o,(0,r._)("td",null,(0,s.zw)(a.form.user.email),1)]),(0,r._)("tr",null,[i,(0,r._)("td",null,(0,s.zw)(a.form.user.name),1)]),(0,r._)("tr",null,[c,(0,r._)("td",null,(0,s.zw)(a.form.user.tel),1)]),(0,r._)("tr",null,[u,(0,r._)("td",null,(0,s.zw)(a.form.user.address),1)]),(0,r._)("tr",null,[m,(0,r._)("td",null,(0,s.zw)(a.form.message),1)]),p])])])}var h={props:{form:{type:Object,default:()=>{}}}},f=a(89);const g=(0,f.Z)(h,[["render",b]]);var _=g},6148:function(t,e,a){a.r(e),a.d(e,{default:function(){return B}});var r=a(3396),s=a(7139);const d=t=>((0,r.dD)("data-v-545b115e"),t=t(),(0,r.Cn)(),t),l={class:"table align-middle table-borderless text-center border mb-3"},n={class:"table-light border-bottom"},o=d((()=>(0,r._)("th",{class:"fw-normal",scope:"col"},"商品資訊",-1))),i=d((()=>(0,r._)("th",{class:"d-none d-md-table-cell fw-normal",scope:"col"},"商品價格",-1))),c=d((()=>(0,r._)("th",{class:"d-none d-md-table-cell fw-normal",scope:"col",width:"180"},"數量",-1))),u={key:0,class:"d-none d-md-table-cell fw-normal",scope:"col"},m={class:"col-12 col-md-auto text-center text-md-start"},p={class:"figure figure--spacing-mobile d-flex justify-content-start align-items-center flex-column flex-md-row m-0"},b={class:"img-box d-flex justify-content-center align-items-center border ms-1 me-2"},h=["src"],f={class:"fs-6 m-0 pt-3 pt-md-0"},g={class:"col-12 col-md-auto p-2"},_={class:"col-12 col-md-auto p-0"},I={key:1,class:"spinner-border spinner-border-sm",role:"status"},w=d((()=>(0,r._)("span",{class:"visually-hidden"},"Loading...",-1))),y=[w],v={key:0,class:"col-12 col-md-auto p-0"},k=["onClick"],L={key:1,class:"spinner-border spinner-border-sm align-middle",role:"status"},C=d((()=>(0,r._)("span",{class:"visually-hidden"},"Loading...",-1))),D=[C],x={key:0,class:"border-top"},q={colspan:"4",class:"text-end fw-medium"},U=(0,r.Uk)(" 折扣"),S={class:"fw-medium ps-3"},O={colspan:"4",class:"text-end fw-bold"},Z=(0,r.Uk)(" 本訂單須支付金額"),$={class:"fw-bold ps-3"},j={key:1,colspan:"4",class:"p-4"},z=(0,r.Uk)(" 您的購物車目前沒有任何商品，"),T=(0,r.Uk)("去購物");function A(t,e,a,d,w,C){const A=(0,r.up)("StoreProductInput"),N=(0,r.up)("router-link");return(0,r.wg)(),(0,r.iD)("div",null,[(0,r._)("table",l,[(0,r._)("thead",n,[(0,r._)("tr",null,[o,i,c,a.isSummary?(0,r.kq)("",!0):((0,r.wg)(),(0,r.iD)("th",u,"變更明細"))])]),(0,r._)("tbody",null,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(t.cart.carts,((e,d)=>((0,r.wg)(),(0,r.iD)("tr",{key:e+d,class:(0,s.C_)([{"td-deleted":t.cartDeletedItem===e.id,"text-muted":t.cartDeletedItem===e.id},"d-flex d-sm-table-row table-row--divider-light flex-wrap justify-content-center m-2"])},[(0,r._)("td",m,[(0,r._)("figure",p,[(0,r._)("div",b,[(0,r._)("img",{src:e.product.imageUrl,alt:"購物車商品圖",class:"img-fluid img-cart-item p-1 rounded"},null,8,h)]),(0,r._)("figcaption",null,[(0,r._)("h2",f,(0,s.zw)(e.product.title),1)])])]),(0,r._)("td",g," NT$ "+(0,s.zw)(e.product.price.toLocaleString("en-us")),1),(0,r._)("td",_,[t.cartLoadingItem!==e.id?((0,r.wg)(),(0,r.j4)(A,{key:0,hasOperators:C.hasOperators,qty:e.qty,itemId:e.id,onUpdateItem:t.updateCartItem,"onUpdate:value":a=>t.updateCartItem({itemId:e.id,qty:a})},null,8,["hasOperators","qty","itemId","onUpdateItem","onUpdate:value"])):(0,r.kq)("",!0),t.cartLoadingItem===e.id?((0,r.wg)(),(0,r.iD)("div",I,y)):(0,r.kq)("",!0)]),a.isSummary?(0,r.kq)("",!0):((0,r.wg)(),(0,r.iD)("td",v,[t.cartDeletedItem!==e.id?((0,r.wg)(),(0,r.iD)("button",{key:0,type:"button",class:"btn btn-deleted bi bi-trash",onClick:a=>t.deleteCartItem(e.id)},null,8,k)):(0,r.kq)("",!0),t.cartDeletedItem===e.id?((0,r.wg)(),(0,r.iD)("div",L,D)):(0,r.kq)("",!0)]))],2)))),128))]),a.isSummary?((0,r.wg)(),(0,r.iD)("tfoot",x,[(0,r._)("tr",null,[(0,r._)("td",q,[U,(0,r._)("span",S,"- NT$ "+(0,s.zw)(t.discount)+"元",1)])]),(0,r._)("tr",null,[(0,r._)("td",O,[Z,(0,r._)("span",$," NT$ "+(0,s.zw)(t.cart.final_total?.toLocaleString("en-us"))+"元",1)])])])):(0,r.kq)("",!0),0===this.cart.carts?.length?((0,r.wg)(),(0,r.iD)("td",j,[z,(0,r.Wm)(N,{to:"/thermos/classic/details/classic-green",class:"text-decoration-none link-classic-green fw-medium"},{default:(0,r.w5)((()=>[T])),_:1})])):(0,r.kq)("",!0)])])}var N=a(4301),R=a(4677),W=a(6294),F=a(8686),P={components:{StoreProductInput:F.Z},props:{isSummary:{type:Boolean,default:!1}},data(){return{tempItem:[]}},computed:{hasOperators(){return!this.isSummary},...(0,N.rn)(R.x,["cart","discount"]),...(0,N.rn)(W.Z,["cartLoadingItem","cartDeletedItem"])},methods:{...(0,N.nv)(R.x,["getCartList","updateCartItem","deleteCartItem"])},created(){this.getCartList()}},V=a(89);const Q=(0,V.Z)(P,[["render",A],["__scopeId","data-v-545b115e"]]);var B=Q},8234:function(t,e,a){a.r(e),a.d(e,{default:function(){return v}});var r=a(3396);const s={class:"container p-3 p-md-5"},d={class:"row"},l={class:"col"},n={class:"row"},o={class:"col"},i={class:"row justify-content-center mt-3"},c={class:"col-6 col-lg-3"},u={class:"col-6 col-lg-3"},m=["disabled"],p={key:0,class:"spinner-border spinner-border-sm text-light",role:"status"},b=(0,r.Uk)(" 確認訂單 ");function h(t,e,a,h,f,g){const _=(0,r.up)("StoreUserCartProductTable"),I=(0,r.up)("StoreUserCartOrderTable");return(0,r.wg)(),(0,r.iD)("div",s,[(0,r._)("div",d,[(0,r._)("div",l,[(0,r.Wm)(_,{isSummary:!0})])]),(0,r._)("div",n,[(0,r._)("div",o,[(0,r.Wm)(I,{form:a.tempForm},null,8,["form"])])]),(0,r._)("div",i,[(0,r._)("div",c,[(0,r._)("button",{type:"button",class:"btn btn-outline-secondary rounded-pill w-100 py-2",onClick:e[0]||(e[0]=t=>this.$router.push({name:"order"}))}," 上一步 ")]),(0,r._)("div",u,[(0,r._)("button",{type:"button",class:"btn btn-dark rounded-pill w-100 py-2",onClick:e[1]||(e[1]=(...t)=>g.confirmOrder&&g.confirmOrder(...t)),disabled:f.isLoading},[f.isLoading?((0,r.wg)(),(0,r.iD)("div",p)):(0,r.kq)("",!0),b],8,m)])])])}var f=a(4827),g=a(6148),_=a(3371),I={components:{StoreUserCartProductTable:g["default"],StoreUserCartOrderTable:_.Z},props:{tempForm:{type:Object,default:()=>{}}},data(){return{orderId:"",isLoading:!1}},methods:{async confirmOrder(){this.isLoading=!0,await(0,f.Vh)({data:this.tempForm}).then((t=>{!0===t.data.success&&(this.orderId=t.data.orderId),this.isLoading=!1})).catch((t=>{})),this.$router.push({name:"checkoutOrder",params:{orderId:this.orderId}})}}},w=a(89);const y=(0,w.Z)(I,[["render",h]]);var v=y}}]);
//# sourceMappingURL=234.0c01112c.js.map