"use strict";(self["webpackChunkmy_project"]=self["webpackChunkmy_project"]||[]).push([[743],{4827:function(t,e,a){a.d(e,{er:function(){return _},Wf:function(){return I},dr:function(){return x},ye:function(){return v},gJ:function(){return y},FC:function(){return w},Vh:function(){return C},sG:function(){return b}});var s=a(6265),o=a.n(s);const c=o().create({baseURL:"https://vue3-course-api.hexschool.io/api/samchiu064-api/"}),i=()=>c.get("/cart"),n=t=>c.post("/cart",t),r=(t,e)=>c.put(`/cart/${e}`,t),l=t=>c.delete(`/cart/${t}`),d=(o().create({baseURL:"https://vue3-course-api.hexschool.io/api/samchiu064-api/"}),o().create({baseURL:"https://vue3-course-api.hexschool.io/api/samchiu064-api/"})),p=t=>d.post("/coupon",t),u=o().create({baseURL:"https://vue3-course-api.hexschool.io/api/samchiu064-api/"}),m=t=>u.get(`/order/${t}`),h=t=>u.post("/order",t),f=o().create({baseURL:"https://vue3-course-api.hexschool.io/api/samchiu064-api/"}),g=()=>f.get("/products"),I=i,y=n,b=r,_=l,w=p,x=m,C=h,v=g},4677:function(t,e,a){a.d(e,{x:function(){return n}});var s=a(4827),o=a(4301),c=a(6294);const i=(0,c.Z)(),n=(0,o.Q_)("cart",{state:()=>({cart:{},itemQty:0}),getters:{discount(){return this.cart.total-this.cart.final_total}},actions:{async getCartList(){i.isLoading=!0;try{const t=await(0,s.Wf)();this.cart=t.data.data}catch(t){i.apiRequestIsFailed=!0,i.apiErrorMessage=t}i.isLoading=!1},async addCartItem(t,e){i.cartLoadingItem=t,i.cartItemIsAdded=!1;try{await(0,s.gJ)({data:{product_id:t,qty:e}}),i.cartLoadingItem="",i.cartItemIsAdded=!0}catch(a){i.cartItemIsAdded=!1,i.apiRequestIsFailed=!0,i.apiErrorMessage=a}this.getCartList()},async updateCartItem({productId:t,qty:e},a){i.cartLoadingItem=t;try{const o=e<=0?1:e;await(0,s.sG)({data:{product_id:t,qty:o}},a),this.getCartList()}catch(o){i.apiRequestIsFailed=!0,i.apiErrorMessage=o}i.cartLoadingItem=""},async deleteCartItem(t){i.cartDeletedItem=t;try{await(0,s.er)(t),this.getCartList()}catch(e){i.apiRequestIsFailed=!0,i.apiErrorMessage=e}this.cancelOverlay()},overlayCartItem(t){i.cartItemIsOverlaid=!0,i.cartDeletedItem=t},cancelOverlay(){i.cartItemIsOverlaid=!1,i.cartDeletedItem=""}}})},6294:function(t,e,a){var s=a(4301);e["Z"]=(0,s.Q_)("statusStore",{state:()=>({isLoading:!1,cartIsShown:!1,cartLoadingItem:"",cartDeletedItem:"",cartItemIsAdded:!1,cartItemIsOverlaid:!1,couponIsApplied:!1,couponIsValid:!1,orderIsValid:!1,apiRequestIsFailed:!1,apiErrorMessage:""})})},3743:function(t,e,a){a.r(e),a.d(e,{default:function(){return Q}});var s=a(3396),o=a(7139),c=a(9242);const i=t=>((0,s.dD)("data-v-603e6b52"),t=t(),(0,s.Cn)(),t),n={class:"col-12 col-lg-4"},r={class:"card"},l=i((()=>(0,s._)("h4",{class:"card-header fs-6 py-2 text-center"},"您的訂單",-1))),d={class:"list-group list-group-flush"},p={class:"list-group-item d-flex justify-content-between align-items-center py-3 px-0 mx-3"},u=i((()=>(0,s._)("h5",{class:"fs-6 m-0 fw-normal"},"小計",-1))),m={class:"fs-6 m-0 fw-medium"},h=i((()=>(0,s._)("li",{class:"list-group-item d-flex justify-content-between align-items-center py-3 px-0 mx-3"},[(0,s._)("h5",{class:"fs-6 m-0 fw-normal"},"運費"),(0,s._)("p",{class:"fs-6 m-0 fw-medium"},"免運費")],-1))),f={class:"list-group-item accordion accordion-flush py-3 px-0 mx-3"},g={class:"accordion-item"},I=i((()=>(0,s._)("h2",{class:"accordion-header",id:"flush-headingOne"},[(0,s._)("button",{type:"button",class:"accordion-button collapsed px-3","data-bs-toggle":"collapse","data-bs-target":"#flush-collapseOne","aria-expanded":"true","aria-controls":"flush-collapseOne"}," 套用折扣碼 ")],-1))),y={id:"flush-collapseOne",class:"accordion-collapse collapse","aria-labelledby":"flush-headingOne","data-bs-parent":"#accordionFlushExample"},b={class:"accordion-body"},_={class:"list-group-flush ps-0"},w=i((()=>(0,s._)("p",null,"已套用",-1))),x={class:"d-flex justify-content-between ps-2"},C={key:0,class:"text-danger fs-7 ps-3 m-0"},v={class:"list-group-item d-flex justify-content-between align-items-center pt-3 px-0 mx-3 border-bottom-0"},L=i((()=>(0,s._)("h5",{class:"fs-6 m-0"},"折扣",-1))),A={class:"fs-6 m-0 fw-medium"},k={class:"list-group-item d-flex justify-content-between align-items-center pb-3 px-0 mx-3 border-bottom-0"},q=i((()=>(0,s._)("h5",{class:"fs-5 m-0 fw-bold"},"總計",-1))),R={class:"fs-5 m-0 fw-bold"},V={class:"list-group-item d-flex justify-content-between align-items-center py-3 px-0 mx-3"},O=["disabled"];function j(t,e,a,i,j,D){return(0,s.wg)(),(0,s.iD)("div",n,[(0,s._)("div",r,[l,(0,s._)("ul",d,[(0,s._)("li",p,[u,(0,s._)("p",m,"NT$ "+(0,o.zw)(t.cart.total?.toLocaleString("en-us")),1)]),h,(0,s._)("li",f,[(0,s._)("div",g,[I,(0,s._)("div",y,[(0,s._)("div",b,[(0,s._)("ul",_,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(t.couponList,((t,e)=>((0,s.wg)(),(0,s.iD)("li",{key:t+e,class:"d-flex justify-content-between ps-2"},[(0,s._)("p",null,(0,o.zw)(t),1),w])))),128)),(0,s._)("li",x,[(0,s.wy)((0,s._)("input",{class:"form-control form-control-sm w-70",type:"text",placeholder:"請輸入折扣碼 summer","aria-label":"折扣碼輸入處","onUpdate:modelValue":e[0]||(e[0]=e=>t.couponCode=e),onClick:e[1]||(e[1]=()=>{t.couponIsValid=!0,t.couponIsApplied=!1})},null,512),[[c.nr,t.couponCode]]),(0,s._)("button",{type:"button",class:"btn btn-outline-secondary",onClick:e[2]||(e[2]=(...t)=>D.addCoupon&&D.addCoupon(...t))}," 套用 ")])]),!t.couponIsValid&&0!==t.couponCode.length||t.couponIsApplied?((0,s.wg)(),(0,s.iD)("span",C,(0,o.zw)(D.errorMessage),1)):(0,s.kq)("",!0)])])])]),(0,s._)("li",v,[L,(0,s._)("p",A,"- "+(0,o.zw)(t.discount?.toLocaleString("en-us")),1)]),(0,s._)("li",k,[q,(0,s._)("p",R,"NT $"+(0,o.zw)(t.cart.final_total?.toLocaleString("en-us")),1)]),(0,s._)("li",V,[(0,s._)("button",{type:"button",class:"btn btn-dark w-100 rounded-pill",disabled:0===this.cart.carts?.length||"order"===this.$route.name&&!a.formIsValid,onClick:e[3]||(e[3]=e=>t.$router.push({name:a.nextPage}))}," 下一步 ",8,O)])])])])}var D=a(4301),F=a(4827),M=a(6294);const E=(0,M.Z)(),$=(0,D.Q_)("coupon",{state:()=>({couponCode:"",couponList:[]}),actions:{async applyCoupon(){const t=this.couponCode;try{const e=await(0,F.FC)({data:{code:t}});if(e.data.success){if(this.couponList.includes(t))return void(E.couponIsApplied=!0);this.couponList.push(t),this.couponCode=""}else E.couponIsValid=!1}catch(e){E.apiRequestIsFailed=!0,E.apiErrorMessage=e}}}});var S=a(4677),U={props:{nextPage:{type:String,required:!0},formIsValid:{type:Boolean,default:()=>!0}},computed:{errorMessage(){return this.couponIsValid?this.couponIsApplied?"已套用的優惠券":"":"無效的優惠券"},...(0,D.rn)(S.x,["discount"]),...(0,D.Ah)(S.x,["cart"]),...(0,D.Ah)($,["couponCode","couponList"]),...(0,D.Ah)(M.Z,["couponIsApplied","couponIsValid"])},methods:{async addCoupon(){await this.applyCoupon(),await this.getCartList()},...(0,D.nv)($,["applyCoupon"]),...(0,D.nv)(S.x,["getCartList"])}},z=a(89);const Z=(0,z.Z)(U,[["render",j],["__scopeId","data-v-603e6b52"]]);var Q=Z}}]);
//# sourceMappingURL=743.a1fe29dd.js.map